<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Vitalog</title>

  <!-- Fuente -->
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">

  <!-- Tus CSS -->
  <link rel="stylesheet" href="assets/css/variables.css">
  <link rel="stylesheet" href="assets/css/base.css">
  <link rel="stylesheet" href="assets/css/components.css">

  <!-- Ajustes mínimos para layout del topbar para evitar encimados -->
  <style>
    .topbar{
      display:flex; align-items:center; gap:16px;
      padding:12px 16px; background:#ccecee;
    }
    .topbar .brand{display:flex; align-items:center; gap:10px}
    .topbar .brand img{height:28px}
    .topbar .brand .sep-logo{height:26px}
    .topbar .user{
      margin-left:auto; display:flex; align-items:center; gap:8px; font-weight:600;
    }
    .topbar .user img{height:24px}
    .topbar .actions{
      display:flex; align-items:center; gap:10px; margin-left:16px;
    }
    .btn{display:inline-flex; align-items:center; gap:8px; border:0; border-radius:12px; padding:10px 16px; font-weight:600; cursor:pointer}
    .btn img{height:18px}
    .btn-primary{ background:#1a76e5; color:#fff;}
    .btn-primary:hover{filter:brightness(1.05)}
    .btn-secondary{ background:#0b5a74; color:#fff;}
    .btn-danger{ background:#ff5757; color:#fff;}
    .btn-ghost{ background:#e2fcdb; color:#0b5a74;}
    .icon-btn{
      border:0; background:#fff; border-radius:12px; width:44px; height:44px; display:flex; align-items:center; justify-content:center; cursor:pointer;
    }
    .icon-btn img{height:22px}
    .user-menu{
      position:absolute; right:16px; top:72px;
      background:#fff; border-radius:14px; padding:8px; width:320px; box-shadow:0 8px 28px rgba(0,0,0,.12);
    }
    .user-menu button{
      width:100%; display:flex; align-items:center; gap:10px;
      border:0; background:#eef7fb; padding:12px; border-radius:12px; margin:6px 0; cursor:pointer;
      font-weight:600;
    }
    .user-menu button img{height:18px}
    .page{
      padding:14px 16px 28px;
      background:#ccecee;
      min-height:100dvh;
    }
    /* tabla */
    .card{background:#daf0f4; border-radius:14px; padding:0}
    table{width:100%; border-collapse:separate; border-spacing:0}
    thead th{
      text-align:left; padding:16px; color:#0b5a74; font-weight:700;
      background:#d5eef1; position:sticky; top:0; z-index:1;
    }
    tbody td{padding:18px 16px; background:#fff; border-bottom:1px solid #e3edf0}
    .t-center{text-align:center}
    .t-cap{text-transform:capitalize}
    /* diálogos (estilo básico) */
    dialog{ border:0; border-radius:18px; padding:0; width:min(720px, 94vw); }
    dialog::backdrop{ background:rgba(0,0,0,.3) }
    .dlg{
      padding:18px;
    }
    .dlg h3{ margin:0 0 12px; font-size:18px}
    .form-grid{ display:grid; grid-template-columns:1fr 1fr; gap:12px}
    .form-grid .full{ grid-column:1 / -1 }
    .field{ display:flex; flex-direction:column; gap:6px}
    .field label{ font-size:13px; font-weight:600; color:#0b5a74 }
    .field input, .field select, .field textarea{
      border:1px solid #cfe0e5; background:#fff; border-radius:10px; padding:10px; font-size:14px
    }
    .dlg-actions{ display:flex; gap:10px; justify-content:flex-end; margin-top:14px}
  </style>
</head>

<body>

  <!-- =============== VIEW: WELCOME / landing ================= -->
  <section data-view="welcome" class="page" hidden>
    <header class="topbar">
      <div class="brand">
        <img src="assets/brand/logoini.svg" alt="Vitalog" />
        <img src="assets/brand/logofin.svg" class="sep-logo" alt="logo icon" />
      </div>
      <div class="user">
        <img src="assets/avatars/avatarh.svg" alt="avatar" />
        <span>Invitado</span>
      </div>
    </header>

    <div style="padding:28px 6px">
      <button class="btn btn-primary" data-action="go-login">
        Iniciar sesión
      </button>
      <button class="btn btn-secondary" data-action="go-register">
        Solicitar registro
      </button>
    </div>
  </section>

  <!-- =============== VIEW: LOGIN ================= -->
  <section data-view="login" class="page" hidden>
    <header class="topbar">
      <div class="brand">
        <img src="assets/brand/logoini.svg" alt="Vitalog" />
        <img src="assets/brand/logofin.svg" class="sep-logo" alt="logo icon" />
      </div>
      <button class="btn btn-ghost" data-action="back-home">⬅ Volver</button>
      <div class="user" aria-hidden="true"></div>
    </header>

    <div style="padding:20px 6px; max-width:680px">
      <div class="field">
        <label>Correo electrónico</label>
        <input id="li-email" type="email" placeholder="tucorreo@ejemplo.com" />
      </div>
      <div class="field" style="margin-top:10px">
        <label>Contraseña</label>
        <input id="li-pass" type="password" placeholder="••••••••" />
      </div>
      <div style="margin-top:16px">
        <button class="btn btn-primary" data-action="login">Iniciar sesión</button>
      </div>
    </div>
  </section>

  <!-- =============== VIEW: APP (principal) ================= -->
  <section data-view="app" class="page">
    <!-- TOPBAR -->
    <header class="topbar">
      <div class="brand">
        <img src="assets/brand/logoini.svg" alt="Vitalog" />
        <img src="assets/brand/logofin.svg" class="sep-logo" alt="">
      </div>

      <!-- Acciones principales -->
      <div class="actions">
        <button class="btn btn-primary" data-action="open-new">
          <img src="assets/icons/ui/nuevo.svg" alt="" /> Nuevo
        </button>

        <button class="btn btn-secondary" data-action="open-edit">
          <img src="assets/icons/ui/editar.svg" alt="" /> Editar
        </button>

        <button class="btn btn-danger" data-action="open-delete">
          <img src="assets/icons/ui/borrar.svg" alt="" /> Borrar
        </button>

        <button class="btn btn-primary" data-action="toggle-sort" title="Ordenar">
          <img src="assets/icons/ui/filtro.svg" alt="" style="transform:rotate(90deg)" />
          Ordenar
        </button>

        <button class="btn btn-primary" data-action="open-filters" title="Filtros">
          <img src="assets/icons/ui/filtro.svg" alt="" />
          Filtros
        </button>
      </div>

      <!-- Usuario + menú -->
      <div class="user">
        <img src="assets/avatars/avatarh.svg" alt="avatar" />
        <span id="topbarUser">julianluzanilla@hotmail.com</span>
      </div>
      <button class="icon-btn" id="btnMenu" data-action="toggle-menu" aria-label="Menú">
        <img src="assets/icons/ui/menu.svg" alt="">
      </button>
    </header>

    <!-- MENÚ DE USUARIO -->
    <div id="userMenu" class="user-menu" hidden>
      <button data-action="open-profile">
        <img src="assets/icons/ui/usuario.svg" alt=""> Actualizar datos personales
      </button>
      <button data-action="change-password">
        <img src="assets/icons/ui/password.svg" alt=""> Cambiar contraseña
      </button>
      <button data-action="export-data">
        <img src="assets/icons/ui/exportar.svg" alt=""> Exportar datos (csv > email)
      </button>
      <button data-action="backup-device">
        <img src="assets/icons/ui/respaldo.svg" alt=""> Respaldar en este dispositivo
      </button>
      <button data-action="logout" style="background:#ffe7e7">
        <img src="assets/icons/ui/logout.svg" alt=""> Cerrar sesión
      </button>
    </div>

    <!-- TABLA -->
    <div class="card" style="margin-top:10px">
      <table>
        <thead>
          <tr>
            <th data-sort="datetime">Hora <span class="chevron">▲</span></th>
            <th data-sort="type">Tipo <span class="chevron">▲</span></th>
            <th data-sort="notes">Valores y comentarios <span class="chevron">▲</span></th>
            <th class="t-center">Sel.</th>
          </tr>
        </thead>
        <tbody id="logTableBody">
          <!-- filas generadas por app.js -->
        </tbody>
      </table>
    </div>
  </section>

  <!-- =============== DIALOG: NUEVO REGISTRO ================= -->
  <dialog id="dlgNew">
    <div class="dlg">
      <h3>Nuevo registro</h3>

      <div class="form-grid">
        <div class="field">
          <label>Fecha</label>
          <input id="newDate" type="date">
        </div>
        <div class="field">
          <label>Hora</label>
          <input id="newTime" type="time">
        </div>

        <div class="field full">
          <label>Tipo de registro</label>
          <select id="newType">
            <option value="presion">Presión arterial</option>
            <option value="ritmo">Ritmo cardiaco</option>
            <option value="peso">Peso</option>
            <option value="bano">Baño (pipí)</option>
            <option value="dolor">Dolor</option>
            <option value="mareo">Mareo</option>
            <option value="medicamento">Toma de medicamento</option>
            <option value="sangre">Estudio de sangre</option>
          </select>
        </div>

        <div class="field full">
          <label>Valores / comentarios</label>
          <textarea id="newNotes" rows="4" placeholder="Ej. 120/80 LPM 63 · En casa después de bañarme"></textarea>
        </div>
      </div>

      <div class="dlg-actions">
        <button class="btn" onclick="document.querySelector('#dlgNew').close()">Cancelar</button>
        <button class="btn btn-primary" data-action="save-new">Guardar</button>
      </div>
    </div>
  </dialog>

  <!-- =============== DIALOG: EDITAR REGISTRO ================= -->
  <dialog id="dlgEdit">
    <div class="dlg">
      <h3>Editar registro</h3>

      <input type="hidden" id="editId">

      <div class="form-grid">
        <div class="field">
          <label>Fecha</label>
          <input id="editDate" type="date">
        </div>
        <div class="field">
          <label>Hora</label>
          <input id="editTime" type="time">
        </div>

        <div class="field full">
          <label>Tipo de registro</label>
          <select id="editType">
            <option value="presion">Presión arterial</option>
            <option value="ritmo">Ritmo cardiaco</option>
            <option value="peso">Peso</option>
            <option value="bano">Baño (pipí)</option>
            <option value="dolor">Dolor</option>
            <option value="mareo">Mareo</option>
            <option value="medicamento">Toma de medicamento</option>
            <option value="sangre">Estudio de sangre</option>
          </select>
        </div>

        <div class="field full">
          <label>Valores / comentarios</label>
          <textarea id="editNotes" rows="4"></textarea>
        </div>
      </div>

      <div class="dlg-actions">
        <button class="btn" onclick="document.querySelector('#dlgEdit').close()">Cancelar</button>
        <button class="btn btn-primary" data-action="save-edit">Guardar cambios</button>
      </div>
    </div>
  </dialog>

  <!-- =============== DIALOG: BORRAR REGISTROS ================= -->
  <dialog id="dlgDelete">
    <div class="dlg">
      <h3>Confirmar borrado</h3>
      <p>Vas a borrar <strong><span id="delCount">0</span> registro(s)</strong>. Esta acción no se puede deshacer.</p>
      <div class="dlg-actions">
        <button class="btn" onclick="document.querySelector('#dlgDelete').close()">Cancelar</button>
        <button class="btn btn-danger" data-action="confirm-delete">Borrar</button>
      </div>
    </div>
  </dialog>

  <!-- =============== DIALOG: PERFIL ================= -->
  <dialog id="dlgProfile">
    <div class="dlg">
      <h3>Actualizar datos personales</h3>

      <div class="form-grid">
        <div class="field">
          <label>Nombre(s)</label>
          <input id="pf-first" type="text" placeholder="José">
        </div>
        <div class="field">
          <label>Apellidos</label>
          <input id="pf-last" type="text" placeholder="Pérez">
        </div>

        <div class="field">
          <label>Fecha de nacimiento</label>
          <input id="pf-birth" type="date">
        </div>
        <div class="field">
          <label>Peso (kg)</label>
          <input id="pf-weight" type="number" step="0.1" placeholder="90">
        </div>

        <div class="field">
          <label>Estatura (m)</label>
          <input id="pf-height" type="number" step="0.01" placeholder="1.80">
        </div>

        <div class="field">
          <label>Nivel de actividad</label>
          <select id="pf-activity">
            <option value="sedentario">Sedentario</option>
            <option value="leve">Leve</option>
            <option value="moderado">Moderado</option>
            <option value="en_forma">En forma</option>
            <option value="atleta">Atleta</option>
          </select>
        </div>
      </div>

      <div class="dlg-actions">
        <button class="btn" onclick="document.querySelector('#dlgProfile').close()">Cancelar</button>
        <button class="btn btn-primary" data-action="save-profile">Guardar</button>
      </div>
    </div>
  </dialog>

  <!-- =============== DIALOG: FILTROS (placeholder) ================= -->
  <dialog id="dlgFilters">
    <div class="dlg">
      <h3>Filtros</h3>
      <div class="form-grid">
        <div class="field">
          <label>Desde</label>
          <input type="date" id="fltFrom">
        </div>
        <div class="field">
          <label>Hasta</label>
          <input type="date" id="fltTo">
        </div>
        <div class="field full">
          <label>Tipo</label>
          <select id="fltType">
            <option value="">Todos</option>
            <option value="presion">Presión arterial</option>
            <option value="ritmo">Ritmo cardiaco</option>
            <option value="peso">Peso</option>
            <option value="bano">Baño</option>
            <option value="dolor">Dolor</option>
            <option value="mareo">Mareo</option>
            <option value="medicamento">Medicamento</option>
            <option value="sangre">Estudio de sangre</option>
          </select>
        </div>
      </div>
      <div class="dlg-actions">
        <button class="btn" onclick="document.querySelector('#dlgFilters').close()">Cerrar</button>
        <button class="btn btn-primary" data-action="apply-filters">Aplicar</button>
      </div>
    </div>
  </dialog>

  <!-- Assets & App -->
  <script src="assets/manifest.js" defer></script>
  <script src="assets/app.js" defer></script>
</body>
</html>

